p8105\_hw6\_wc2788
================
Wen Cheng
11/29/2021

## Problem 1

``` r
#load and clean data
birthweight <- read_csv("birthweight.csv") %>%
  janitor::clean_names() %>%
#convert numeric to factor
  mutate(babysex = factor(babysex,
                          levels = c(1, 2),
                          labels = c("male", "female")),
         frace = factor(frace, 
                        levels = c(1, 2, 3, 4, 8, 9), 
                        labels = c("White", "Black", "Asian", "Puerto Rican", "Other", "Unknown")),
         malform = factor(malform, 
                          levels = c(0, 1),
                          labels = c("absent", "present")),
         mrace = factor(mrace, 
                        levels = c(1, 2, 3, 4, 8), 
                        labels = c("White", "Black", "Asian", "Puerto Rican", "Other")))
```

    ## Rows: 4342 Columns: 20

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (20): babysex, bhead, blength, bwt, delwt, fincome, frace, gaweeks, malf...

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
 #check for missing data
sum(is.na(birthweight))
```

    ## [1] 0

There are `nrow(birthweight)` observations and `ncol(birthweight)`
variables in this dataset, and no missing value.

``` r
#propose a regression model
fit = lm(bwt ~ babysex + blength + delwt + fincome + frace + mrace + wtgain, data = birthweight) 
summary(fit)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ babysex + blength + delwt + fincome + frace + 
    ##     mrace + wtgain, data = birthweight)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -1671.3  -212.0    -5.0   203.2  4064.5 
    ## 
    ## Coefficients:
    ##                     Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)       -3553.0681    96.1684 -36.946  < 2e-16 ***
    ## babysexfemale        -7.2516     9.9143  -0.731 0.464557    
    ## blength             126.5506     1.9166  66.028  < 2e-16 ***
    ## delwt                 2.3398     0.2517   9.296  < 2e-16 ***
    ## fincome               0.7738     0.2075   3.730 0.000194 ***
    ## fraceBlack          -22.6665    54.8940  -0.413 0.679690    
    ## fraceAsian           -7.2809    82.4237  -0.088 0.929614    
    ## fracePuerto Rican   -71.0238    53.0818  -1.338 0.180965    
    ## fraceOther           20.7090    88.1182   0.235 0.814209    
    ## mraceBlack         -139.1683    54.7188  -2.543 0.011014 *  
    ## mraceAsian          -26.6589    85.4185  -0.312 0.754982    
    ## mracePuerto Rican   -12.2677    53.5414  -0.229 0.818782    
    ## wtgain                3.4632     0.5006   6.918 5.27e-12 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 324.4 on 4329 degrees of freedom
    ## Multiple R-squared:    0.6,  Adjusted R-squared:  0.5988 
    ## F-statistic:   541 on 12 and 4329 DF,  p-value: < 2.2e-16

``` r
birthweight %>% 
  modelr::add_residuals(fit) %>% 
  modelr::add_predictions(fit) %>% 
  ggplot(aes(x = pred, y = resid)) + 
  geom_point()
```

![](p8105_hw6_wc2788_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->
